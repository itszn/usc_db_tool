(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.database_app=database_app;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _sql=require("./sql.js");var _log=require("./log.js");function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function database_app(){var running=false;$("#btn-remove-col").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(){var collections,body,_iterator,_step,f,res,ops,deleted,i,o,old_name;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!_sql.has_database||running)){_context.next=2;break}return _context.abrupt("return");case 2:running=true;_context.next=5;return(0,_sql.query)("SELECT DISTINCT collection from Collections").then(_sql.sql_all);case 5:collections=_context.sent;console.log(collections);if(!(collections.length===0)){_context.next=11;break}(0,_log.log)("No collections found...");running=false;return _context.abrupt("return");case 11:body="";_iterator=_createForOfIteratorHelper(collections);try{for(_iterator.s();!(_step=_iterator.n()).done;){f=_step.value;body+='\n<div class="field">\n<label class="checkbox">\n  <input type="checkbox">\n  '.concat(esc(f[0]),"\n</label>\n</div>")}}catch(err){_iterator.e(err)}finally{_iterator.f()}_context.next=16;return modal("Select Collection To Delete",body);case 16:res=_context.sent;if(!(res===null)){_context.next=20;break}running=false;return _context.abrupt("return");case 20:ops=$("#modal").find("input");deleted=0;i=0;case 23:if(!(i<collections.length)){_context.next=35;break}o=ops.eq(i);if(o[0].checked){_context.next=27;break}return _context.abrupt("continue",32);case 27:old_name=collections[i][0];_context.next=30;return(0,_sql.query)("DELETE FROM Collections WHERE collection=$oldname",{$oldname:old_name}).then(_sql.sql_all);case 30:res=_context.sent;deleted++;case 32:i++;_context.next=23;break;case 35:(0,_log.log)("Deleted ".concat(deleted," collection(s)"));running=false;case 37:case"end":return _context.stop()}}},_callee)}))()["catch"](_log.show_error)});$("#btn-rename-col").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(){var collections,body,_iterator2,_step2,f,res,ops,old_name,i,o,new_name;return _regenerator["default"].wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!_sql.has_database||running)){_context2.next=2;break}return _context2.abrupt("return");case 2:running=true;_context2.next=5;return(0,_sql.query)("SELECT DISTINCT collection from Collections").then(_sql.sql_all);case 5:collections=_context2.sent;console.log(collections);if(!(collections.length===0)){_context2.next=11;break}(0,_log.log)("No collections found...");running=false;return _context2.abrupt("return");case 11:body="";_iterator2=_createForOfIteratorHelper(collections);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){f=_step2.value;body+='\n<div class="field">\n<label class="radio">\n  <input type="radio">\n  '.concat(esc(f[0]),"\n</label>\n</div>")}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_context2.next=16;return modal("Select Collection To Rename",body);case 16:res=_context2.sent;if(!(res===null)){_context2.next=20;break}running=false;return _context2.abrupt("return");case 20:ops=$("#modal").find("input");old_name=null;i=0;case 23:if(!(i<collections.length)){_context2.next=32;break}o=ops.eq(i);if(o[0].checked){_context2.next=27;break}return _context2.abrupt("continue",29);case 27:old_name=collections[i][0];return _context2.abrupt("break",32);case 29:i++;_context2.next=23;break;case 32:if(!(old_name===null)){_context2.next=36;break}(0,_log.log)("No collection selected");running=false;return _context2.abrupt("return");case 36:_context2.next=38;return get_input("Rename Collection",'Enter the new name for the "'.concat(old_name,'" collection:'),old_name);case 38:new_name=_context2.sent;if(!(new_name===null)){_context2.next=42;break}running=false;return _context2.abrupt("return");case 42:if(!(new_name===old_name)){_context2.next=46;break}(0,_log.log)("New name same as old...");running=false;return _context2.abrupt("return");case 46:(0,_log.log)("Renaming collection '".concat(old_name,"'..."));_context2.next=49;return(0,_sql.query)("UPDATE Collections SET collection=$newname where collection=$oldname",{$oldname:old_name,$newname:new_name}).then(_sql.sql_all);case 49:res=_context2.sent;(0,_log.log)("Collection renamed to '".concat(new_name,"'"));running=false;case 52:case"end":return _context2.stop()}}},_callee2)}))()["catch"](_log.show_error)});$("#btn-stats-folders").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee3(){var _yield$find_folders,_yield$find_folders2,dirs,base_dir,body,_iterator3,_step3,f,res,ops,where,i,o,spath;return _regenerator["default"].wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(!_sql.has_database||running)){_context3.next=2;break}return _context3.abrupt("return");case 2:running=true;_context3.next=5;return find_folders();case 5:_yield$find_folders=_context3.sent;_yield$find_folders2=(0,_slicedToArray2["default"])(_yield$find_folders,2);dirs=_yield$find_folders2[0];base_dir=_yield$find_folders2[1];dirs=Array.from(dirs.values());console.log(dirs);body="";_iterator3=_createForOfIteratorHelper(dirs);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){f=_step3.value;body+='\n<div class="field">\n<label class="checkbox">\n  <input type="checkbox" checked>\n  '.concat(esc(f),"\n</label>\n</div>")}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}_context3.next=16;return modal("Select Folders To Collect Stats For",body);case 16:res=_context3.sent;if(!(res===null)){_context3.next=20;break}running=false;return _context3.abrupt("return");case 20:ops=$("#modal").find("input");console.log(dirs);console.log(ops);where=[];i=0;case 25:if(!(i<dirs.length)){_context3.next=35;break}o=ops.eq(i);console.log(o[0],o[0].checked);if(o[0].checked){_context3.next=30;break}return _context3.abrupt("continue",32);case 30:spath=base_dir+dirs[i];where.push('path LIKE "'.concat(spath,'%"'));case 32:i++;_context3.next=25;break;case 35:console.log(where);if(!(where.length==0)){_context3.next=40;break}_context3.next=39;return do_stats("");case 39:return _context3.abrupt("return");case 40:where=" AND (".concat(where.join(" OR "),")");console.log(where);_context3.next=44;return do_stats(where);case 44:case"end":return _context3.stop()}}},_callee3)}))()["catch"](_log.show_error)});$("#btn-stats").click(function(){if(!_sql.has_database||running)return;running=true;do_stats()});function do_stats(){var where=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee4(){var table,body,prog,volforce,low_best_vol,best_vol,level,raw_scores,scores,best_score,best_hash,_iterator4,_step4,row,_row,hash,name,max_score,raw_misses,_iterator5,_step5,_row2,_row3,_hash,is_uc,chart,raw_ex,_iterator6,_step6,_row4,_row5,_hash2,is_hc,_chart,raw_c,_iterator7,_step7,_row6,_row7,_hash3,is_c,_chart2,avg_list,score_list,_i,_score_list,s,grade,clear,vol,total_vol,vf_classes,vf_class,_i2,_vf_classes,c,stars,i,avg,clr_avg,badges,_i3,_score_list2,score,b,nums;return _regenerator["default"].wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:running=true;(0,_log.log)("Starting stat collection. This may take a few minutes");table=$("<table>").html("\n<thead>\n  <th>Level</th>\n  <th>Average</th>\n  <th>Clear Average</th>\n  <th>Best Score</th>\n  <th># Clear</th>\n  <th># Ex Clear</th>\n  <th># UC</th>\n  <th># PUC</th>\n</thead>\n<tbody>\n</tbody>");body=table.find("tbody");$("#log").append(table);prog=$('<progress value="0" max="4" style="width:100%"></progress>');$("#log").append(prog);volforce=$("<div>0 VF</div>");$("#log").append(volforce);low_best_vol=0;best_vol=[];level=20;case 12:if(!(level>=10)){_context4.next=150;break}prog.attr("value","0");_context4.next=16;return(0,_sql.query)("SELECT hash, title, (SELECT max(s.score) from Scores s where s.chart_hash=hash) from Charts where level=".concat(level," ").concat(where)).then(_sql.sql_all);case 16:raw_scores=_context4.sent;console.log(raw_scores);scores={};best_score=0;best_hash="";_iterator4=_createForOfIteratorHelper(raw_scores);_context4.prev=22;_iterator4.s();case 24:if((_step4=_iterator4.n()).done){_context4.next=36;break}row=_step4.value;_row=(0,_slicedToArray2["default"])(row,3),hash=_row[0],name=_row[1],max_score=_row[2];if(!(max_score===null)){_context4.next=29;break}return _context4.abrupt("continue",34);case 29:if(max_score>best_score){best_score=max_score;best_hash=hash}if(!(hash in scores)){_context4.next=33;break}(0,_log.log)("Duplicate charts found for '".concat(name,"'"));return _context4.abrupt("continue",34);case 33:scores[hash]={score:max_score,badge:max_score===1e7?"puc":"f"};case 34:_context4.next=24;break;case 36:_context4.next=41;break;case 38:_context4.prev=38;_context4.t0=_context4["catch"](22);_iterator4.e(_context4.t0);case 41:_context4.prev=41;_iterator4.f();return _context4.finish(41);case 44:prog.attr("value","1");if(!(Object.keys(scores).length===0)){_context4.next=48;break}body.append($("<tr><td>".concat(level,"</td><td><b>0000</b>000</td><td><b>0000</b>000</td><td><b>0000</b>000</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>")));return _context4.abrupt("continue",147);case 48:_context4.next=50;return(0,_sql.query)("SELECT hash, (SELECT 1 from Scores s where s.chart_hash=hash and s.miss=0 limit 1) from Charts where level=".concat(level," ").concat(where)).then(_sql.sql_all);case 50:raw_misses=_context4.sent;console.log(raw_misses);_iterator5=_createForOfIteratorHelper(raw_misses);_context4.prev=53;_iterator5.s();case 55:if((_step5=_iterator5.n()).done){_context4.next=66;break}_row2=_step5.value;_row3=(0,_slicedToArray2["default"])(_row2,2),_hash=_row3[0],is_uc=_row3[1];if(!(is_uc!==1)){_context4.next=60;break}return _context4.abrupt("continue",64);case 60:chart=scores[_hash];if(!(chart.badge!="f")){_context4.next=63;break}return _context4.abrupt("continue",64);case 63:chart.badge="uc";case 64:_context4.next=55;break;case 66:_context4.next=71;break;case 68:_context4.prev=68;_context4.t1=_context4["catch"](53);_iterator5.e(_context4.t1);case 71:_context4.prev=71;_iterator5.f();return _context4.finish(71);case 74:prog.attr("value","2");_context4.next=77;return(0,_sql.query)("SELECT hash, (SELECT 1 from Scores s where s.chart_hash=hash and s.gameflags&1=1 and s.gauge>0 limit 1) from Charts where level=".concat(level," ").concat(where)).then(_sql.sql_all);case 77:raw_ex=_context4.sent;console.log(raw_ex);_iterator6=_createForOfIteratorHelper(raw_ex);_context4.prev=80;_iterator6.s();case 82:if((_step6=_iterator6.n()).done){_context4.next=93;break}_row4=_step6.value;_row5=(0,_slicedToArray2["default"])(_row4,2),_hash2=_row5[0],is_hc=_row5[1];if(!(is_hc!==1)){_context4.next=87;break}return _context4.abrupt("continue",91);case 87:_chart=scores[_hash2];if(!(_chart.badge!="f")){_context4.next=90;break}return _context4.abrupt("continue",91);case 90:_chart.badge="hc";case 91:_context4.next=82;break;case 93:_context4.next=98;break;case 95:_context4.prev=95;_context4.t2=_context4["catch"](80);_iterator6.e(_context4.t2);case 98:_context4.prev=98;_iterator6.f();return _context4.finish(98);case 101:prog.attr("value","3");_context4.next=104;return(0,_sql.query)("SELECT hash, (SELECT 1 from Scores s where s.chart_hash=hash and s.gameflags&1=0 and s.gauge>0.7 limit 1) from Charts where level=".concat(level," ").concat(where)).then(_sql.sql_all);case 104:raw_c=_context4.sent;console.log(raw_c);prog.attr("value","4");_iterator7=_createForOfIteratorHelper(raw_c);_context4.prev=108;_iterator7.s();case 110:if((_step7=_iterator7.n()).done){_context4.next=121;break}_row6=_step7.value;_row7=(0,_slicedToArray2["default"])(_row6,2),_hash3=_row7[0],is_c=_row7[1];if(!(is_c!==1)){_context4.next=115;break}return _context4.abrupt("continue",119);case 115:_chart2=scores[_hash3];if(!(_chart2.badge!="f")){_context4.next=118;break}return _context4.abrupt("continue",119);case 118:_chart2.badge="c";case 119:_context4.next=110;break;case 121:_context4.next=126;break;case 123:_context4.prev=123;_context4.t3=_context4["catch"](108);_iterator7.e(_context4.t3);case 126:_context4.prev=126;_iterator7.f();return _context4.finish(126);case 129:avg_list=function avg_list(l){if(l.length===0)return 0;return l.reduce(function(a,b){return a+b})/l.length};console.log("Calcing");score_list=Object.values(scores);for(_i=0,_score_list=score_list;_i<_score_list.length;_i++){s=_score_list[_i];grade=.8;if(s.score>=99e5)grade=1.05;else if(s.score>=98e5)grade=1.02;else if(s.score>=97e5)grade=1;else if(s.score>=95e5)grade=.97;else if(s.score>=93e5)grade=.94;else if(s.score>=9e6)grade=.91;else if(s.score>=87e5)grade=.88;else if(s.score>=75e5)grade=.85;else if(s.score>=65e5)grade=.82;clear={puc:1.1,uc:1.05,hc:1.02,c:1,f:.5}[s.badge];vol=level*2*(s.score/1e7)*grade*clear;vol=parseInt(vol)/100;if(best_vol.length<50||low_best_vol<vol){best_vol.push(vol);if(best_vol.length>50){best_vol=best_vol.sort().slice(-50);low_best_vol=best_vol[0]}}}total_vol=best_vol.reduce(function(a,b){return a+b});total_vol=parseInt(total_vol*1e3)/1e3;vf_classes=[[0,"Sienna","brown","white",[0,2.5,5,7.5]],[10,"Cobalt","navy","white",[10,10.5,11,11.5]],[12,"Dandelion","#fcc800","black",[12,12.5,13,13.5]],[14,"Cyan","#25b7c0","black",[14,14.25,14.5,14.75]],[15,"Scarlet","#f73562","white"[15,15.25,15.5,15.75]],[16,"Coral","#ff69b4","white",[16,16.25,16.5,16.75]],[17,"Argento","#d5ddef","black",[17,17.25,17.5,17.75]],[18,"Eldora","gold","black",[18,18.25,18.5,18.75]],[19,"Crimson","red","white",[19,19.25,19.5,19.75]],[20,"Imperial","purple","white",[20,21,22,23]]];vf_class=void 0;for(_i2=0,_vf_classes=vf_classes;_i2<_vf_classes.length;_i2++){c=_vf_classes[_i2];if(total_vol>=c[0])vf_class=c}stars=1;for(i=0;i<vf_class[4].length;i++){if(total_vol>vf_class[4][i])stars=i+1}volforce.text("".concat(total_vol," VF (").concat(vf_class[1]," ").concat("★".repeat(stars),")"));avg=avg_list(score_list.map(function(x){return x.score}));clr_avg=avg_list(score_list.filter(function(x){return x.badge!=="f"}).map(function(x){return x.score}));badges={};for(_i3=0,_score_list2=score_list;_i3<_score_list2.length;_i3++){score=_score_list2[_i3];b=score.badge;badges[b]=(badges[b]?badges[b]:0)+1}nums=function nums(n){n=parseInt(n);if(n===1e7)return"<b>10000</b>000";n=n.toString();n="0".repeat(7-n.length)+n;return"<b>".concat(n.slice(0,4),"</b>").concat(n.slice(4))};body.append($("\n<tr>\n  <td>".concat(level,"</td>\n  <td>").concat(nums(avg),"</td>\n  <td>").concat(nums(clr_avg),"</td>\n  <td>").concat(nums(best_score),"</td>\n  <td>").concat(badges.c?badges.c:0,"</td>\n  <td>").concat(badges.hc?badges.hc:0,"</td>\n  <td>").concat(badges.uc?badges.uc:0,"</td>\n  <td>").concat(badges.puc?badges.puc:0,"</td>\n</tr>")));case 147:level--;_context4.next=12;break;case 150:prog.remove();running=false;case 152:case"end":return _context4.stop()}}},_callee4,null,[[22,38,41,44],[53,68,71,74],[80,95,98,101],[108,123,126,129]])}))()["catch"](_log.show_error)}$("#btn-dump").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee5(){return _regenerator["default"].wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(!_sql.has_database||running)){_context5.next=2;break}return _context5.abrupt("return");case 2:running=true;_context5.next=5;return(0,_sql.query)("SELECT path from Charts limit 20").then(_sql.sql_all).then(function(res){(0,_log.log)("Path of first 20 charts:");var _iterator8=_createForOfIteratorHelper(res),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var r=_step8.value;(0,_log.log)(r)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}});case 5:_context5.next=7;return(0,_sql.query)("SELECT path from Folders limit 20").then(_sql.sql_all).then(function(res){(0,_log.log)("Path of first 20 folders:");var _iterator9=_createForOfIteratorHelper(res),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var r=_step9.value;(0,_log.log)(r)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}});case 7:running=false;case 8:case"end":return _context5.stop()}}},_callee5)}))()["catch"](_log.show_error)});function find_folders(_x){return _find_folders.apply(this,arguments)}function _find_folders(){_find_folders=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee9(all_rows){var _yield$find_base_path3,_yield$find_base_path4,base_dir,sep,dirs,_iterator12,_step12,row,path;return _regenerator["default"].wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!(all_rows===undefined)){_context9.next=4;break}_context9.next=3;return(0,_sql.query)("SELECT rowid, path, folderid from Charts").then(_sql.sql_all);case 3:all_rows=_context9.sent;case 4:_context9.next=6;return find_base_path(all_rows);case 6:_yield$find_base_path3=_context9.sent;_yield$find_base_path4=(0,_slicedToArray2["default"])(_yield$find_base_path3,2);base_dir=_yield$find_base_path4[0];sep=_yield$find_base_path4[1];base_dir+=sep;(0,_log.log)("Base dir is ".concat(base_dir));dirs=new Set;console.log(base_dir);_iterator12=_createForOfIteratorHelper(all_rows);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){row=_step12.value;path=row[1];path=path.slice(base_dir.length);path=path.split(sep)[0];dirs.add(path)}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}return _context9.abrupt("return",[dirs,base_dir]);case 17:case"end":return _context9.stop()}}},_callee9)}));return _find_folders.apply(this,arguments)}function find_base_path(_x2){return _find_base_path.apply(this,arguments)}function _find_base_path(){_find_base_path=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee10(all_rows){var possible_path,sep,_iterator13,_step13,row,path,i;return _regenerator["default"].wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(!(all_rows===undefined)){_context10.next=4;break}_context10.next=3;return(0,_sql.query)("SELECT rowid, path, folderid from Charts").then(_sql.sql_all);case 3:all_rows=_context10.sent;case 4:possible_path=[];sep=all_rows[0][1][0]==="/"?"/":"\\";_iterator13=_createForOfIteratorHelper(all_rows);_context10.prev=7;_iterator13.s();case 9:if((_step13=_iterator13.n()).done){_context10.next=30;break}row=_step13.value;path=row[1].split(sep);if(!(possible_path.length===0)){_context10.next=16;break}possible_path=path;console.log(possible_path);return _context10.abrupt("continue",28);case 16:i=0;case 17:if(!(i<path.length)){_context10.next=28;break}if(!(i>=possible_path.length)){_context10.next=20;break}return _context10.abrupt("break",28);case 20:if(!(path[i]!==possible_path[i])){_context10.next=25;break}possible_path=path.slice(0,i);console.log("checked",path);console.log(possible_path);return _context10.abrupt("break",28);case 25:i++;_context10.next=17;break;case 28:_context10.next=9;break;case 30:_context10.next=35;break;case 32:_context10.prev=32;_context10.t0=_context10["catch"](7);_iterator13.e(_context10.t0);case 35:_context10.prev=35;_iterator13.f();return _context10.finish(35);case 38:return _context10.abrupt("return",[possible_path.join(sep),sep]);case 39:case"end":return _context10.stop()}}},_callee10,null,[[7,32,35,38]])}));return _find_base_path.apply(this,arguments)}$("#btn-paths").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee7(){var all_rows,_yield$find_base_path,_yield$find_base_path2,old_path,sep,new_path,charts_to_flush,flush_charts,update_count,folder_updates,_iterator11,_step11,row,_row8,id,path,fid,updated_path,folder_path,_i4,_Object$entries,f;return _regenerator["default"].wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!(!_sql.has_database||running)){_context7.next=2;break}return _context7.abrupt("return");case 2:running=true;(0,_log.log)("Finding main song folder");_context7.next=6;return(0,_sql.query)("SELECT rowid, path, folderid from Charts").then(_sql.sql_all);case 6:all_rows=_context7.sent;_context7.next=9;return find_base_path(all_rows);case 9:_yield$find_base_path=_context7.sent;_yield$find_base_path2=(0,_slicedToArray2["default"])(_yield$find_base_path,2);old_path=_yield$find_base_path2[0];sep=_yield$find_base_path2[1];_context7.next=15;return get_input("Original Song Directory Path","This is our guess of your original song folder, modify it if not correct:",old_path);case 15:old_path=_context7.sent;if(!(old_path===null)){_context7.next=19;break}running=false;return _context7.abrupt("return");case 19:if(old_path[old_path.length-1]!=sep)old_path+=sep;(0,_log.log)("Old song path is ".concat(old_path));_context7.next=23;return get_input("New Song Directory Path","Enter the new absolute song folder path you want to use:",old_path);case 23:new_path=_context7.sent;if(!(new_path===null)){_context7.next=27;break}running=false;return _context7.abrupt("return");case 27:if(new_path[new_path.length-1]!=sep)new_path+=sep;(0,_log.log)("New song path is ".concat(new_path));(0,_log.log)("Updating chart paths...");charts_to_flush=[];flush_charts=function(){var _ref7=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee6(table){var force,ps,q,or,_iterator10,_step10,c,_c,id,path,_args6=arguments;return _regenerator["default"].wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:force=_args6.length>1&&_args6[1]!==undefined?_args6[1]:false;if(!(charts_to_flush.length===0)){_context6.next=3;break}return _context6.abrupt("return");case 3:ps={};q="UPDATE ".concat(table," SET path = (case ");or="";_iterator10=_createForOfIteratorHelper(charts_to_flush);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){c=_step10.value;_c=(0,_slicedToArray2["default"])(c,2),id=_c[0],path=_c[1];q+="when rowid=".concat(id," then $path").concat(id," ");or+="or rowid=".concat(id," ");ps["$path".concat(id)]=path}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}q+="end) where ".concat(or.slice(3));console.log(q);charts_to_flush.length=0;_context6.next=13;return(0,_sql.query)(q,ps);case 13:case"end":return _context6.stop()}}},_callee6)}));return function flush_charts(_x3){return _ref7.apply(this,arguments)}}();update_count=0;folder_updates={};_iterator11=_createForOfIteratorHelper(all_rows);_context7.prev=35;_iterator11.s();case 37:if((_step11=_iterator11.n()).done){_context7.next=49;break}row=_step11.value;_row8=(0,_slicedToArray2["default"])(row,3),id=_row8[0],path=_row8[1],fid=_row8[2];if(path.startsWith(old_path)){_context7.next=42;break}return _context7.abrupt("continue",47);case 42:updated_path=new_path+path.slice(old_path.length);if(!(fid in folder_updates)){folder_path=updated_path.split(sep).slice(0,-1).join(sep);folder_updates[fid]=folder_path}update_count++;charts_to_flush.push([id,updated_path]);if(charts_to_flush.length>=100){flush_charts("Charts")}case 47:_context7.next=37;break;case 49:_context7.next=54;break;case 51:_context7.prev=51;_context7.t0=_context7["catch"](35);_iterator11.e(_context7.t0);case 54:_context7.prev=54;_iterator11.f();return _context7.finish(54);case 57:flush_charts("Charts");(0,_log.log)("Done updating charts with new path. Updated path on ".concat(update_count," charts"));update_count=0;for(_i4=0,_Object$entries=Object.entries(folder_updates);_i4<_Object$entries.length;_i4++){f=_Object$entries[_i4];charts_to_flush.push(f);update_count++;if(charts_to_flush.length>=100){flush_charts("Folders")}}flush_charts("Folders");(0,_log.log)("Done updating folders with new path. Updated path on ".concat(update_count," folders"));running=false;case 64:case"end":return _context7.stop()}}},_callee7,null,[[35,51,54,57]])}))()["catch"](_log.show_error)});$("#btn-download").click(function(){(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee8(){return _regenerator["default"].wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!(!_sql.has_database||running)){_context8.next=2;break}return _context8.abrupt("return");case 2:running=true;(0,_sql.download)();case 4:case"end":return _context8.stop()}}},_callee8)}))()["catch"](_log.show_error)})}},{"./log.js":2,"./sql.js":4,"@babel/runtime/helpers/asyncToGenerator":8,"@babel/runtime/helpers/interopRequireDefault":9,"@babel/runtime/helpers/slicedToArray":12,"@babel/runtime/regenerator":16}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.log=log;exports.log_h=log_h;exports.show_error=show_error;function log(msg){$("#log").append(msg+"\n")}function log_h(msg){$("#log").append($(msg+"<br/>"))}function show_error(msg){$("#errormsg").text(msg).show();throw msg}},{}],3:[function(require,module,exports){"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _sql=require("./sql.js");var _database_app=require("./database_app.js");var _log=require("./log.js");var _util=require("./util.js");var inputElement=document.getElementById("database");inputElement.addEventListener("change",(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(){var file;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=this.files[0];$("#inputdb").hide();_context.next=4;return(0,_sql.start_sql)(file);case 4:$("#actions").show();(0,_database_app.database_app)();case 6:case"end":return _context.stop()}}},_callee,this)})),false)},{"./database_app.js":1,"./log.js":2,"./sql.js":4,"./util.js":5,"@babel/runtime/helpers/asyncToGenerator":8,"@babel/runtime/helpers/interopRequireDefault":9,"@babel/runtime/regenerator":16}],4:[function(require,module,exports){"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.start_sql=start_sql;exports.query=query;exports.sql_first=sql_first;exports.sql_all=sql_all;exports.download=download;exports.has_database=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof"));var _log=require("./log.js");var wasm_supported=function(){try{if((typeof WebAssembly==="undefined"?"undefined":(0,_typeof2["default"])(WebAssembly))==="object"&&typeof WebAssembly.instantiate==="function"){var module=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(module instanceof WebAssembly.Module)return new WebAssembly.Instance(module)instanceof WebAssembly.Instance}}catch(e){}return false}();var worker;var has_database=false;exports.has_database=has_database;window.sql_cbs={};var sqlid=1;function query(sql){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(resolve){var sid=sqlid++;window.sql_cbs[sid]=resolve;console.log("running");worker.postMessage({id:sid,action:"exec",sql:sql,params:params})})}function sql_first(results){if(results===undefined)return null;return results.values[0]}function sql_all(results){if(results===undefined)return[];return results.values}function start_sql(file){return new Promise(function(resolve,reject){if(wasm_supported){worker=new Worker("./lib/worker.sql-wasm.js")}else{(0,_log.log_h)('<font color="red">NOTE: Your browser does not support WASM, this tool will run much slower...</font>');worker=new Worker("./lib/worker.sql-asm.js")}worker.onmessage=function(){console.log("Database opened");worker.onmessage=function(event){var data=event.data;console.log(data);if(data.id in window.sql_cbs){var cb=window.sql_cbs[data.id];delete window.sql_cbs[data.id];if(data.error){(0,_log.show_error)(data.error)}if(data.results){cb(data.results[0])}}};query("SELECT version from Database").then(sql_first).then(function(res){var _res=(0,_slicedToArray2["default"])(res,1),ver=_res[0];if(ver<14||ver>18){(0,_log.show_error)("Database is version ".concat(ver,". This app only supports databases with versions 14-17"));reject("Bad version")}exports.has_database=has_database=true;(0,_log.log)("USC Database loaded (version ".concat(ver,")"));resolve()})};console.log(file);var reader=new FileReader;reader.onload=function(evt){var db=evt.target.result;console.log(db);worker.postMessage({id:sqlid++,action:"open",buffer:db})};reader.readAsArrayBuffer(file);worker.onerror=function(e){console.error("Worker error: ",e);(0,_log.show_error)(e)}})}function download(){worker.onmessage=function(event){(0,_log.log)("Exporting the database");var arraybuff=event.data.buffer;var blob=new Blob([arraybuff]);var a=document.createElement("a");document.body.appendChild(a);a.href=window.URL.createObjectURL(blob);a.download="maps_modified.db";a.onclick=function(){setTimeout(function(){window.URL.revokeObjectURL(a.href)},1500)};a.click();(0,_log.log)("Closing Database: refresh to restart");exports.has_database=has_database=false};worker.postMessage({action:"export"})}},{"./log.js":2,"@babel/runtime/helpers/interopRequireDefault":9,"@babel/runtime/helpers/slicedToArray":12,"@babel/runtime/helpers/typeof":13}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.esc=esc;exports.modal=modal;exports.get_input=get_input;function esc(data){return $("<div>").text(data).html()}function modal(title,body){return new Promise(function(resolve){var c=$("#modal").addClass("is-active").find(".modal-content").html('\n<div class="box">\n  <div class="content">\n    <h3 class="is-3">'.concat(esc(title),"</h3>\n    <p>").concat(body,'</p>\n    <button class="button btno is-fullwidth">Ok</button>\n    <button class="button btnc is-fullwidth is-danger">Cancel</button>\n  </div>\n</div>'));c.find(".btno").click(function(x){$("#modal").removeClass("is-active");resolve(true)});c.find(".btnc").click(function(x){$("#modal").removeClass("is-active");resolve(null)})})}function get_input(title,body){var val=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";return new Promise(function(resolve){var c=$("#modal").addClass("is-active").find(".modal-content").html('\n<div class="box">\n  <div class="content">\n    <h3 class="is-3">'.concat(esc(title),"</h3>\n    <p>").concat(esc(body),'</p>\n    <input class="input" type="text">\n    <button class="button btno is-fullwidth">Ok</button>\n    <button class="button btnc is-fullwidth is-danger">Cancel</button>\n  </div>\n</div>'));c.find(".btno").click(function(x){$("#modal").removeClass("is-active");resolve(c.find("input")[0].value)});c.find(".btnc").click(function(x){$("#modal").removeClass("is-active");resolve(null)});c.find("input")[0].value=val})}},{}],6:[function(require,module,exports){function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}module.exports=_arrayLikeToArray},{}],7:[function(require,module,exports){function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}module.exports=_arrayWithHoles},{}],8:[function(require,module,exports){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}module.exports=_asyncToGenerator},{}],9:[function(require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_interopRequireDefault},{}],10:[function(require,module,exports){function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}module.exports=_iterableToArrayLimit},{}],11:[function(require,module,exports){function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=_nonIterableRest},{}],12:[function(require,module,exports){var arrayWithHoles=require("./arrayWithHoles");var iterableToArrayLimit=require("./iterableToArrayLimit");var unsupportedIterableToArray=require("./unsupportedIterableToArray");var nonIterableRest=require("./nonIterableRest");function _slicedToArray(arr,i){return arrayWithHoles(arr)||iterableToArrayLimit(arr,i)||unsupportedIterableToArray(arr,i)||nonIterableRest()}module.exports=_slicedToArray},{"./arrayWithHoles":7,"./iterableToArrayLimit":10,"./nonIterableRest":11,"./unsupportedIterableToArray":14}],13:[function(require,module,exports){function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){module.exports=_typeof=function _typeof(obj){return typeof obj}}else{module.exports=_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}module.exports=_typeof},{}],14:[function(require,module,exports){var arrayLikeToArray=require("./arrayLikeToArray");function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return arrayLikeToArray(o,minLen)}module.exports=_unsupportedIterableToArray},{"./arrayLikeToArray":6}],15:[function(require,module,exports){var runtime=function(exports){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});return obj[key]}try{define({},"")}catch(err){define=function(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}exports.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction");function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg)})})}exports.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};exports.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;define(genFun,toStringTagSymbol,"GeneratorFunction")}genFun.prototype=Object.create(Gp);return genFun};exports.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg)}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)})}return PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};exports.AsyncIterator=AsyncIterator;exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){if(PromiseImpl===void 0)PromiseImpl=Promise;var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if(method==="throw"){throw arg}return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next"){context.sent=context._sent=context.arg}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return"){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator["return"]){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);define(Gp,toStringTagSymbol,"Generator");Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}exports.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}exports.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined}return ContinueSentinel}};return exports}(typeof module==="object"?module.exports:{});try{regeneratorRuntime=runtime}catch(accidentalStrictMode){Function("r","regeneratorRuntime = r")(runtime)}},{}],16:[function(require,module,exports){module.exports=require("regenerator-runtime")},{"regenerator-runtime":15}]},{},[3]);
